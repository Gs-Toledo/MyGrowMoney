name: Frontend CI Pipeline

on:
    # Manual trigger
    workflow_dispatch:
    push:
        branches:
            - '*' 
    pull_request:
        branches:
            - '*' 

jobs:
    build:
        name: Test Frontend (Vite + Vue)
        runs-on: ubuntu-latest

        steps:
            # Step 1: Checkout the code
            - name: Checkout code
              uses: actions/checkout@v3

            # Step 2: Set up Node.js
            - name: Set up Node.js
              uses: actions/setup-node@v3
              with:
                  node-version: '18'

            # Step 3: Cache Node.js dependencies for testing
            - name: Cache Node.js modules
              uses: actions/cache@v3
              with:
                  path: ~/.cache/npm
                  key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}

            # Step 4: Install dependencies
            - name: Install dependencies
              working-directory: ./front-end
              run: npm ci

            # Step 5: Run frontend tests
            - name: Test
              working-directory: ./front-end
              run: npm run test

            # Step 6: Build the frontend
            - name: Build
            working-directory: ./front-end
            run: npm run build